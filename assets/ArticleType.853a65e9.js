/* empty css                  *//* empty css                 */import{_ as e}from"./Back.vue_vue&type=style&index=0&lang.2346707b.js";/* empty css                   *//* empty css                    *//* empty css                */import"./el-form-item.c6f666bf.js";import{f as t,w as a,x as l,g as s,h as o,j as r,J as i,y as u,z as p,r as d,T as n,a1 as m,C as c,a9 as f,aa as g,ab as y,A as h,B as v,o as b,m as w,D as _,n as V,F as L,H as C,t as j}from"./vendor.cc5c9397.js";const T={class:"create-type-section"},x={class:"create-type-form"},N=["src"],k=C("正常"),A=C("冻结");var U=t({name:"ArticleType",setup(t){const{proxy:U}=a(),D=l(),I=s(""),J=s(!1),S=U.$serverUrl,$=s("default"),z=s(),B=o({name:"ArticleType",title:"",fileList:[],description:"",status:"0",pageNum:10}),F=s({});s([]);const O=s();r((()=>{let e=D.currentRoute.value.query.typeId;e&&(O.value=e,H())}));const q=o({title:[{required:!0,message:"请输入分类名称",trigger:"blur"}]}),M=e=>{I.value=e.url,J.value=!0},R=e=>{const t=new FormData;for(let a in e)"fileList"==a?(e.fileList.forEach((e=>{t.append("file",e.raw)})),0===e.fileList.length&&t.append("file","")):t.append(a,e[a]);return t};let E={headers:{token:document.cookie,"Content-Type":"multipart/form-data"}};const H=()=>{U.$axios.get("/typeDataByTypeId",{params:{typeId:O.value},headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return i({showClose:!0,message:e.data.msg,type:"error"}),D.push({name:"Login"});if(1080==e.data.status){i({showClose:!0,message:e.data.msg,type:"success"});let t=e.data.data[0];if(B.title=t.title,""!=t.imgMore){let e=t.imgMore.split(",");for(let t=0;t<e.length;t++)B.fileList.push({url:S+"/"+e[t]})}B.description=t.description,B.status=Number(t.status).toString(),B.pageNum=t.pageNum,F.value=JSON.parse(JSON.stringify(B))}else i({showClose:!0,message:e.data.msg,type:"error"})})).catch((e=>{console.log("error",e)}))};let P={};const G=async e=>{if(!e)return;let t=R(B);await e.validate(((e,a)=>{var l,s;e?O.value?(e=>{for(let a in B)if("fileList"===a)if(B[a].length==F.value[a].length)for(let e=0;e<B[a].length;e++)F.value[a][e].url!=B[a][e].url&&(P[a]=B[a]);else P[a]=B[a];else F.value[a]!=B[a]&&(P[a]=B[a]);if("{}"==JSON.stringify(P))return D.push({name:"ArticleTypeList"});P.typeId=O.value,P.type="ArticleType";let t=R(P);U.$axios.post("/editType",t,e).then((e=>1041==e.data.status?(i({showClose:!0,message:e.data.msg,type:"error"}),D.push({name:"Login"})):1090==e.data.status?(i({showClose:!0,message:e.data.msg,type:"success"}),D.push({name:"ArticleTypeList"})):void i({showClose:!0,message:e.data.msg,type:"error"}))).catch((e=>{console.log("error",e)}))})(E):(l=t,s=E,U.$axios.post("/createType",l,s).then((e=>1041==e.data.status?(i({showClose:!0,message:e.data.msg,type:"error"}),D.push({name:"Login"})):1050==e.data.status?(i({showClose:!0,message:e.data.msg,type:"success"}),D.push({name:"ArticleTypeList"})):void i({showClose:!0,message:e.data.msg,type:"error"}))).catch((e=>{console.log("error",e)}))):console.log("error submit!",a)}))};return(t,a)=>{const l=u,s=p,o=d("Plus"),r=n,i=m,U=c,D=f,S=g,F=y,R=h,E=v;return b(),w("div",T,[_(e,{title:"添加文章分类"}),V("div",x,[_(E,{ref_key:"typeDataRef",ref:z,model:B,rules:q,"label-width":"120px",class:"demo-ruleForm",size:$.value,"status-icon":""},{default:L((()=>[_(s,{label:"文章类型名称",prop:"title"},{default:L((()=>[_(l,{modelValue:B.title,"onUpdate:modelValue":a[0]||(a[0]=e=>B.title=e),placeholder:"输入类型名称"},null,8,["modelValue"])])),_:1}),_(s,{label:"图片"},{default:L((()=>[_(i,{"list-type":"picture-card","auto-upload":!1,limit:1,"file-list":B.fileList,"onUpdate:file-list":a[1]||(a[1]=e=>B.fileList=e),accept:".png,.jpg,.jpeg,.webp","on-preview":M},{default:L((()=>[_(r,{color:"#999999"},{default:L((()=>[_(o)])),_:1})])),_:1},8,["file-list"]),_(U,{modelValue:J.value,"onUpdate:modelValue":a[2]||(a[2]=e=>J.value=e)},{default:L((()=>[V("img",{"w-full":"",src:I.value,alt:"图片预览"},null,8,N)])),_:1},8,["modelValue"])])),_:1}),_(s,{label:"描述"},{default:L((()=>[_(l,{modelValue:B.description,"onUpdate:modelValue":a[3]||(a[3]=e=>B.description=e),type:"textarea"},null,8,["modelValue"])])),_:1}),_(s,{label:"状态"},{default:L((()=>[_(S,{modelValue:B.status,"onUpdate:modelValue":a[4]||(a[4]=e=>B.status=e)},{default:L((()=>[_(D,{label:"0"},{default:L((()=>[k])),_:1}),_(D,{label:"1"},{default:L((()=>[A])),_:1})])),_:1},8,["modelValue"])])),_:1}),_(s,{label:"页数"},{default:L((()=>[_(F,{modelValue:B.pageNum,"onUpdate:modelValue":a[5]||(a[5]=e=>B.pageNum=e),min:1,max:100},null,8,["modelValue"])])),_:1}),_(s,null,{default:L((()=>[_(R,{type:"primary",onClick:a[6]||(a[6]=e=>G(z.value))},{default:L((()=>[C(j(O.value?"保存":"创建分类"),1)])),_:1})])),_:1})])),_:1},8,["model","rules","size"])])])}}});export{U as default};
