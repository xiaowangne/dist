/* empty css                  *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import{t as e,N as a}from"./nopic.b9cd70dd.js";import"./el-form-item.c6f666bf.js";import{f as t,x as s,w as l,h as o,g as r,j as u,a3 as d,A as i,y as n,z as p,a4 as c,a5 as m,B as f,a6 as y,a7 as g,o as h,m as v,n as k,D as w,F as C,I as b,a8 as _,J as z,H as A,t as j,c as x}from"./vendor.cc5c9397.js";const I={class:"type-list"},S={class:"seach-section"},T={class:"create-type"},L=A("添加文章分类"),V=A("删除选择"),$=A("查询"),M={class:"type-list-table"},D=["src"],U=A("编辑 "),E=A("启用 "),q=A("冻结 "),B=A("删除 "),F={class:"pagination-box"};var H=t({name:"ArticleTypeList",setup(t){const H=s(),{proxy:J}=l(),N=J.$serverUrl,R=o({title:"",status:"-1"}),G=r({}),K=o({total:0,pagerCount:5,pageSize:10,pageArray:[2,5,10,20,30,50,100,200],offset:0}),O=r([]),P=r([]);u((()=>{W()}));const Q=d((()=>O.value.length>0)),W=()=>{K.total=0,K.offset=0,G.value=R,te(),X()},X=()=>{let a={offset:K.offset,count:K.pageSize};for(let e in G.value)"status"==e&&"-1"==G.value[e]||!G.value[e]||(a[e]=G.value[e]);J.$axios.get("/typeList",{params:a,headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return H.push({name:"Login"});1060==a.data.status&&(a.data.data.forEach((a=>{a.createdAt=e.formatDate(a.createdAt,"yyyy-MM-dd hh:mm:ss"),a.updatedAt=e.formatDate(a.updatedAt,"yyyy-MM-dd hh:mm:ss")})),P.value=a.data.data,te())})).catch((e=>{console.log("error",e)}))},Y=e=>{J.$axios({method:"post",url:"/typeStatus",data:{typeId:e.typeId,status:0==e.status?1:0,type:"ArticleType"},headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return H.push({name:"Login"});1070==a.data.status&&1==a.data.data.result[0]?(z({message:a.data.msg,showClose:!0,type:"success"}),e.status=a.data.data.status):z({message:a.data.msg,type:"error",showClose:!0})})).catch((e=>{console.log("err ==> ",e)}))},Z=e=>{O.value=[],e.forEach((e=>{O.value.push(e.typeId)}))},ee=e=>{J.$axios({method:"post",url:"/removeType",data:{typeIds:e,type:"ArticleType"},headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return H.push({name:"Login"});1100==e.data.status?(z({message:e.data.msg,showClose:!0,type:"success"}),P.value=[],W()):z({message:e.data.msg,type:"error",showClose:!0})})).catch((e=>{console.log("err ==> ",e)}))},ae=()=>{ee(O.value)},te=()=>{let e={};for(let a in G.value)"status"==a&&"-1"==G.value[a]||!G.value[a]||(e[a]=G.value[a]);J.$axios.get("/typeCount",{params:e,headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return H.push({name:"Login"});1110==e.data.status&&(K.total=e.data.data[0].count)})).catch((e=>{console.log("error",e)}))},se=e=>{K.offset=0,K.pageSize=e,X()},le=e=>{K.offset=(e-1)*K.pageSize,X()},oe=()=>{H.push({name:"ArticleType"})};return(e,t)=>{const s=i,l=n,o=p,r=c,u=m,d=f,z=y,J=g;return h(),v("div",I,[k("div",S,[k("div",T,[w(s,{type:"primary",onClick:oe},{default:C((()=>[L])),_:1}),w(s,{type:"danger",disabled:!b(Q),onClick:ae},{default:C((()=>[V])),_:1},8,["disabled"])]),w(d,{inline:!0,model:R,class:"demo-form-inline"},{default:C((()=>[w(o,{label:"类型名称"},{default:C((()=>[w(l,{modelValue:R.title,"onUpdate:modelValue":t[0]||(t[0]=e=>R.title=e),placeholder:"输入类型名称"},null,8,["modelValue"])])),_:1}),w(o,{label:"状态"},{default:C((()=>[w(u,{modelValue:R.status,"onUpdate:modelValue":t[1]||(t[1]=e=>R.status=e),placeholder:"输入状态"},{default:C((()=>[w(r,{label:"选择状态",value:"-1"}),w(r,{label:"正常",value:"0"}),w(r,{label:"冻结",value:"1"})])),_:1},8,["modelValue"])])),_:1}),w(o,null,{default:C((()=>[w(s,{type:"primary",onClick:W},{default:C((()=>[$])),_:1})])),_:1})])),_:1},8,["model"])]),k("div",M,[w(b(_),{ref:"multipleTableRef",data:P.value,onSelectionChange:Z},{default:C((()=>[w(z,{type:"selection",width:"55"}),w(z,{property:"title",label:"名称",width:"120"}),w(z,{property:"status",label:"状态",width:"120","show-overflow-tooltip":""},{default:C((e=>[A(j(0==e.row.status?"正常":"冻结"),1)])),_:1}),w(z,{label:"更新时间",width:"180"},{default:C((e=>[A(j(e.row.createdAt),1)])),_:1}),w(z,{label:"图片",width:"180"},{default:C((e=>[k("img",{src:""==e.row.img?b(a):b(N)+"/"+e.row.img},null,8,D)])),_:1}),w(z,{label:"操作"},{default:C((e=>[w(s,{size:"small",type:"default",plain:"",onClick:a=>{return t=e.row.typeId,void H.push({name:"ArticleType",query:{typeId:t}});var t}},{default:C((()=>[U])),_:2},1032,["onClick"]),1==e.row.status?(h(),x(s,{key:0,size:"small",type:"success",plain:"",onClick:a=>Y(e.row)},{default:C((()=>[E])),_:2},1032,["onClick"])):(h(),x(s,{key:1,size:"small",type:"warning",plain:"",onClick:a=>Y(e.row)},{default:C((()=>[q])),_:2},1032,["onClick"])),w(s,{size:"small",type:"danger",plain:"",onClick:a=>{return t=e.row.typeId,void ee([t]);var t}},{default:C((()=>[B])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),k("div",F,[w(J,{background:"","pager-count":K.pagerCount,"page-size":K.pageSize,"page-sizes":K.pageArray,layout:"total, sizes, prev, pager, next, jumper",total:K.total,onSizeChange:se,onCurrentChange:le},null,8,["pager-count","page-size","page-sizes","total"])])])])}}});export{H as default};
