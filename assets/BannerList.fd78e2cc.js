/* empty css                  *//* empty css                      *//* empty css                 *//* empty css               *//* empty css                  *//* empty css                  */import{t as a,N as e}from"./nopic.b9cd70dd.js";import"./el-form-item.c6f666bf.js";import{f as t,x as s,w as l,g as o,h as d,j as n,a3 as r,A as u,y as i,z as p,a4 as c,a5 as m,B as f,a6 as g,a7 as h,o as y,m as b,n as v,D as k,F as w,I as C,a8 as _,J as I,G as z,ac as j,H as x,t as A,c as V}from"./vendor.cc5c9397.js";const S={class:"type-list"},L={class:"seach-section"},$={class:"create-type"},B=x("添加轮播图"),M=x("删除选择"),U=x("查询"),D={class:"type-list-table"},E=["src"],N=x("编辑 "),T=x("启用 "),q=x("冻结 "),F=x("删除 "),G={class:"pagination-box"};var H=t({name:"BannerList",setup(t){const H=s(),{proxy:J}=l(),R=J.$serverUrl;o([]);const K=d({title:"",typeId:"-1",status:"-1"}),O=o({}),P=d({total:0,pagerCount:5,pageSize:10,pageArray:[2,5,10,20,30,50,100,200],offset:0}),Q=o([]),W=a=>{P.offset=0,P.pageSize=a,ta()},X=a=>{P.offset=(a-1)*P.pageSize,ta()},Y=o([]),Z=o([]);n((()=>{ea(),la()}));const aa=r((()=>Q.value.length>0)),ea=()=>{P.total=0,P.offset=0,O.value=K,sa(),ta()},ta=()=>{let e={offset:P.offset,count:P.pageSize};for(let a in K)("status"!=a&&"typeId"!=a||"-1"!=K[a])&&K[a]&&(e[a]=K[a]);J.$axios.get("/bannerList",{params:e,headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return H.push({name:"Login"});1280==e.data.status&&(e.data.data.forEach((e=>{e.createdAt=a.formatDate(e.createdAt,"yyyy-MM-dd hh:mm:ss"),e.updatedAt=a.formatDate(e.updatedAt,"yyyy-MM-dd hh:mm:ss")})),Y.value=e.data.data,sa())})).catch((a=>{console.log("error",a)}))},sa=()=>{let a={};for(let e in O.value)("status"!=e&&"typeId"!=e||"-1"!=O.value[e])&&O.value[e]&&(a[e]=O.value[e]);J.$axios.get("/bannerCount",{params:a,headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return H.push({name:"Login"});1300==a.data.status&&(P.total=a.data.data[0].count)})).catch((a=>{console.log("error",a)}))},la=()=>{J.$axios.get("/bannerType",{headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return H.push({name:"Login"});1230==a.data.status&&(Z.value=a.data.data)})).catch((a=>{console.log("error",a)}))},oa=a=>{J.$axios({method:"post",url:"/bannerStatus",data:{typeId:a.typeId,banId:a.banId,status:0==a.status?1:0},headers:{token:document.cookie}}).then((e=>{if(1041==e.data.status)return H.push({name:"Login"});1290==e.data.status&&1==e.data.data.result[0]?(I({message:e.data.msg,showClose:!0,type:"success"}),a.status=e.data.data.status):I({message:e.data.msg,type:"error",showClose:!0})})).catch((a=>{console.log("err ==> ",a)}))},da=a=>{Q.value=[],a.forEach((a=>{Q.value.push(a.banId)}))},na=a=>{J.$axios({method:"post",url:"/removeBanner",data:{banIds:a},headers:{token:document.cookie}}).then((a=>{if(1041==a.data.status)return H.push({name:"Login"});1330==a.data.status?(I({message:a.data.msg,showClose:!0,type:"success"}),Y.value=[],ea()):I({message:a.data.msg,type:"error",showClose:!0})})).catch((a=>{console.log("err ==> ",a)}))},ra=()=>{na(Q.value)},ua=()=>{H.push({name:"AddBanner"})};return(a,t)=>{const s=u,l=i,o=p,d=c,n=m,r=f,I=g,J=h;return y(),b("div",S,[v("div",L,[v("div",$,[k(s,{type:"primary",onClick:ua},{default:w((()=>[B])),_:1}),k(s,{type:"danger",disabled:!C(aa),onClick:ra},{default:w((()=>[M])),_:1},8,["disabled"])]),k(r,{inline:!0,model:K,class:"demo-form-inline"},{default:w((()=>[k(o,{label:"标题"},{default:w((()=>[k(l,{modelValue:K.title,"onUpdate:modelValue":t[0]||(t[0]=a=>K.title=a),placeholder:"输入标题"},null,8,["modelValue"])])),_:1}),k(o,{label:"类型"},{default:w((()=>[k(n,{modelValue:K.typeId,"onUpdate:modelValue":t[1]||(t[1]=a=>K.typeId=a),placeholder:"选择类型"},{default:w((()=>[k(d,{label:"选择类型",value:"-1"}),(y(!0),b(z,null,j(Z.value,(a=>(y(),V(d,{label:a.title,value:a.typeId,key:a.typeId},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),k(o,{label:"状态"},{default:w((()=>[k(n,{modelValue:K.status,"onUpdate:modelValue":t[2]||(t[2]=a=>K.status=a),placeholder:"选择状态"},{default:w((()=>[k(d,{label:"选择状态",value:"-1"}),k(d,{label:"正常",value:"0"}),k(d,{label:"冻结",value:"1"})])),_:1},8,["modelValue"])])),_:1}),k(o,null,{default:w((()=>[k(s,{type:"primary",onClick:ta},{default:w((()=>[U])),_:1})])),_:1})])),_:1},8,["model"])]),v("div",D,[k(C(_),{ref:"multipleTableRef",data:Y.value,onSelectionChange:da},{default:w((()=>[k(I,{type:"selection",width:"55"}),k(I,{prop:"typeName",label:"类型",width:"120"}),k(I,{property:"title",label:"标题",width:"120"}),k(I,{property:"status",label:"状态",width:"120","show-overflow-tooltip":""},{default:w((a=>[x(A(0==a.row.status?"正常":"冻结"),1)])),_:1}),k(I,{label:"更新时间",width:"180"},{default:w((a=>[x(A(a.row.createdAt),1)])),_:1}),k(I,{label:"图片",width:"180"},{default:w((a=>[v("img",{src:""==a.row.img?C(e):C(R)+"/"+a.row.img},null,8,E)])),_:1}),k(I,{label:"操作"},{default:w((a=>[k(s,{size:"small",type:"default",plain:"",onClick:e=>{return t=a.row.banId,void H.push({name:"AddBanner",query:{banId:t}});var t}},{default:w((()=>[N])),_:2},1032,["onClick"]),1==a.row.status?(y(),V(s,{key:0,size:"small",type:"success",plain:"",onClick:e=>oa(a.row)},{default:w((()=>[T])),_:2},1032,["onClick"])):(y(),V(s,{key:1,size:"small",type:"warning",plain:"",onClick:e=>oa(a.row)},{default:w((()=>[q])),_:2},1032,["onClick"])),k(s,{size:"small",type:"danger",plain:"",onClick:e=>{return t=a.row.banId,void na([t]);var t}},{default:w((()=>[F])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),v("div",G,[k(J,{background:"","pager-count":P.pagerCount,"page-size":P.pageSize,"page-sizes":P.pageArray,layout:"total, sizes, prev, pager, next, jumper",total:P.total,onSizeChange:W,onCurrentChange:X},null,8,["pager-count","page-size","page-sizes","total"])])])])}}});export{H as default};
